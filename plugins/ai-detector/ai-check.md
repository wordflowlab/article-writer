---
description: AI味自检 - 检测并优化AI生成痕迹
argument-hint: [文件路径]
allowed-tools: Read(//workspaces/**/*.md)
---

# AI味自检

## 功能说明

利用AI自身的能力,深度分析文章的"AI味"特征,并提供精准的优化建议。

**核心优势**: AI最了解自己的生成模式,能准确识别AI痕迹。

---

## 使用方式

### 方式1: 检测draft.md
```
/ai-check
```
自动查找当前项目的draft.md文件

### 方式2: 指定文件
```
/ai-check workspaces/wechat/articles/001-*/draft.md
```

---

## 检测流程

### 步骤1: 读取文章

**AI操作**:
- 读取指定的文章文件
- 提取正文内容(忽略frontmatter和元信息)
- 统计基础数据: 总字数、段落数、句子数

---

### 步骤2: 四维度分析

#### 维度1: 词汇层面 (30分)

**检测逻辑**:

```
1. 统计高频AI词汇:
   - "综上所述", "因此", "然而", "此外"
   - "值得注意的是", "需要强调的是"
   - "一方面...另一方面"

   评分标准:
   - 0次: 30分
   - 1-3次: 25分
   - 4-6次: 15分
   - 7次以上: 0分

2. 统计空洞形容词:
   - "非常", "极其", "十分", "相当"
   - "很", "特别" (单独使用,无具体修饰)

   扣分标准: 每出现1次扣2分

3. 计算连接词密度:
   - 连接词总数 / 总字数 > 3%: 扣分
```

**AI执行**:
使用正则表达式或关键词匹配,统计上述词汇出现次数。

---

#### 维度2: 结构层面 (30分)

**检测逻辑**:

```
1. 段落长度方差分析:
   - 计算所有段落字数
   - 计算方差: Var = Σ(xi - x̄)² / n

   评分标准:
   - 方差 > 30: 30分 (自然)
   - 方差 20-30: 20分 (基本自然)
   - 方差 10-20: 10分 (略显机械)
   - 方差 < 10: 0分 (高度机械)

2. 公式化模板检测:
   - 开头是否为: "本文将...", "通过本文..."
   - 结尾是否为: "综上所述...", "总而言之..."
   - 每发现1处扣5分

3. 过度列表化检测:
   - 统计列表(1/2/3 或 - 项)数量
   - 列表项 > 文章段落数的50%: 扣10分
```

---

#### 维度3: 情感层面 (20分)

**检测逻辑**:

```
1. 第一人称统计:
   - "我", "我的", "我们" 出现次数
   - "笔者"出现次数

   评分标准:
   - "我"类 > 5次: 20分
   - "我"类 3-5次: 15分
   - "我"类 1-2次或只有"笔者": 5分
   - 完全没有: 0分

2. 情感词汇检测:
   - 积极: "高兴", "惊喜", "兴奋", "满意"
   - 消极: "失望", "沮丧", "遗憾", "意外"
   - 中性但有情绪: "惊讶", "疑惑", "好奇"

   评分: 每出现1个情感词+2分(最多10分)

3. 真实细节检测:
   - 具体时间: "三个月前", "上周二", "2024年1月"
   - 具体地点: "在家里", "公司会议室", "咖啡厅"
   - 具体数字: "测试了27次", "用了3小时"

   评分: 每出现1处真实细节+3分(最多10分)
```

---

#### 维度4: 口语化层面 (20分)

**检测逻辑**:

```
1. 语气词统计:
   - "啊", "呢", "吧", "嘛", "哈", "哎"

   评分标准:
   - > 5个: 20分
   - 3-5个: 15分
   - 1-2个: 5分
   - 0个: 0分

2. 反问句检测:
   - 句子以"吗?", "呢?", "吧?"结尾
   - 或包含"难道", "怎么", "为什么"的疑问句

   评分: 每出现1个反问句+3分(最多10分)

3. 口语化表达检测:
   - "说实话", "老实说", "坦白讲"
   - "我觉得", "感觉", "估计"
   - "有点", "挺", "蛮", "还行"

   评分: 每出现1处口语化+2分(最多10分)
```

---

### 步骤3: 生成检测报告

**输出格式** (参考):

```
🤖 AI味检测报告

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 总体评分: {{score}}/100
AI味等级: {{stars}} ({{level}})
预估AI检测率: {{aiDetectionRate}}%
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 基础数据

- 总字数: {{wordCount}}字
- 段落数: {{paragraphCount}}个
- 平均段落长度: {{avgParagraphLength}}字
- 句子数: {{sentenceCount}}个

---

## 分维度评分

### 1. 词汇层面: {{vocab_score}}/30 {{status_icon}}

**AI词汇检测**:
{{#if ai_words}}
- ❌ 检测到高频AI词汇: {{ai_words_count}}处
  {{#each ai_words}}
  - "{{word}}" ({{count}}次) - 位于: 第{{lines}}行
  {{/each}}
{{else}}
- ✅ 未检测到典型AI词汇
{{/if}}

**空洞形容词检测**:
{{#if empty_adjectives}}
- ⚠️  检测到空洞形容词: {{empty_adj_count}}处
  {{#each empty_adjectives}}
  - "{{word}}" ({{count}}次)
  {{/each}}
{{else}}
- ✅ 形容词使用得当
{{/if}}

**改进建议**:
{{#each vocab_suggestions}}
- {{type}}: "{{old}}" → "{{new}}"
  位置: 第{{line}}行
{{/each}}

---

### 2. 结构层面: {{structure_score}}/30 {{status_icon}}

**段落分析**:
- 段落长度方差: {{variance}} {{#if variance_low}}(⚠️  过于整齐){{/if}}
- 段落长度分布:
  {{#each paragraphs}}
  - 第{{index}}段: {{length}}字
  {{/each}}

**模板化检测**:
{{#if template_found}}
- ❌ 检测到公式化模板:
  {{#each templates}}
  - {{type}}: "{{text}}" (第{{line}}行)
  {{/each}}
{{else}}
- ✅ 未检测到明显模板痕迹
{{/if}}

**改进建议**:
{{#each structure_suggestions}}
- {{suggestion}}
{{/each}}

---

### 3. 情感层面: {{emotion_score}}/20 {{status_icon}}

**第一人称使用**:
- "我/我的/我们": {{first_person_count}}次
- "笔者": {{author_count}}次
{{#if first_person_low}}
- ⚠️  第一人称使用偏少,缺少个人视角
{{/if}}

**情感表达**:
{{#if emotion_words}}
- ✅ 检测到情感词汇: {{emotion_count}}个
  {{#each emotions}}
  - {{word}} ({{type}})
  {{/each}}
{{else}}
- ❌ 缺少情感表达,过于客观
{{/if}}

**真实细节**:
{{#if real_details}}
- ✅ 包含真实细节: {{detail_count}}处
  {{#each details}}
  - {{type}}: "{{text}}"
  {{/each}}
{{else}}
- ❌ 缺少真实细节(时间/地点/具体数字)
{{/if}}

**改进建议**:
{{#each emotion_suggestions}}
- {{suggestion}}
{{/each}}

---

### 4. 口语化层面: {{colloquial_score}}/20 {{status_icon}}

**语气词统计**:
{{#if modal_particles}}
- ✅ 检测到语气词: {{modal_count}}个
  - {{modal_list}}
{{else}}
- ❌ 缺少语气词,过于书面化
{{/if}}

**反问句统计**:
- 反问句: {{rhetorical_count}}个
{{#if rhetorical_low}}
- ⚠️  建议增加反问句,增强互动感
{{/if}}

**口语化表达**:
{{#if colloquial_expressions}}
- ✅ 检测到口语化表达: {{colloquial_count}}处
  {{#each colloquial_expressions}}
  - "{{expression}}"
  {{/each}}
{{else}}
- ⚠️  缺少口语化表达
{{/if}}

**改进建议**:
{{#each colloquial_suggestions}}
- {{suggestion}}
{{/each}}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 🎯 优化建议 (优先级排序)

### P0 (必须修改)
{{#each p0_suggestions}}
{{index}}. {{title}}
   位置: {{location}}
   旧: {{old}}
   新: {{new}}
   理由: {{reason}}

{{/each}}

### P1 (建议修改)
{{#each p1_suggestions}}
{{index}}. {{suggestion}}

{{/each}}

### P2 (可选优化)
{{#each p2_suggestions}}
- {{suggestion}}
{{/each}}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 📈 预期优化效果

如果按 P0+P1 建议修改:
- 预计评分: {{current_score}} → {{expected_score}}
- AI味等级: {{current_level}} → {{expected_level}}
- 预估AI检测率: {{current_rate}}% → {{expected_rate}}%

建议修改后重新运行 /ai-check 验证效果。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 💡 通用建议

根据您的工作区({{workspace}}),以下是特别提醒:

{{#if wechat}}
- 公众号AI味目标: < 30%
- 注意: 微信算法对AI内容不友好,建议评分至少85+
- 特别注意: 段落长度控制在150字以内
{{/if}}

{{#if video}}
- 视频脚本AI味目标: < 20%
- 注意: 口语化是关键,当前口语化评分:  {{colloquial_score}}/20
- 建议: 写完后大声读一遍,不顺口的地方就是AI味重的地方
{{/if}}

{{#if general}}
- 通用内容AI味目标: < 30%
- 注意: 根据目标平台调整风格
{{/if}}
```

---

## AI Prompt模板

**系统提示词**:

```
你是一个专业的"AI生成内容"检测专家。你深刻理解AI生成文本的特征,包括:

1. 词汇特征:
   - 高频词: "综上所述", "因此", "然而", "此外", "值得注意的是"
   - 空洞形容词: "非常", "极其", "十分", "相当"
   - 过度使用连接词

2. 结构特征:
   - 段落长度过于均匀(方差小)
   - 公式化的开头/结尾
   - 机械的列表堆砌

3. 情感特征:
   - 缺少第一人称
   - 缺少情感表达
   - 缺少真实细节(时间/地点/具体数字)

4. 口语化特征:
   - 缺少语气词(啊/呢/吧/嘛)
   - 缺少反问句
   - 过于书面化

你的任务是按照以下4个维度(词汇30分、结构30分、情感20分、口语化20分)
深度分析文章,给出评分和优化建议。

**重要**:
- 要具体标注问题位置(段落/行号)
- 给出可操作的改写建议
- 优先级分为P0(必须)/P1(建议)/P2(可选)
```

---

## 配置文件

可在项目根目录创建 `.ai-check.json`:

```json
{
  "mode": "strict",
  "workspace": "auto",
  "thresholds": {
    "score": {
      "excellent": 85,
      "good": 70,
      "acceptable": 60,
      "poor": 60
    },
    "aiWords": {
      "max": 3
    },
    "variance": {
      "min": 20
    },
    "emotion": {
      "min": 3
    },
    "colloquial": {
      "min": 5
    }
  },
  "customRules": {
    "aiWords": ["综上所述", "因此", "然而"],
    "emptyAdj": ["非常", "极其", "十分"],
    "modalParticles": ["啊", "呢", "吧", "嘛"]
  }
}
```

---

## 注意事项

1. **不要过度优化**: 评分85+即可,过度优化反而不自然
2. **考虑上下文**: 技术文章本身就较书面,不必强求口语化
3. **保持真实性**: 优化时保持内容真实,不要为了降AI味而编造
4. **多次检测**: 修改后重新检测,验证优化效果

---

## 与其他命令的集成

- `/review style` 会自动调用此检测
- `/write` 完成后可手动调用检测初稿
- `/check` 发布前最后检测一次
