---
description: 理解写作需求并保存brief
argument-hint: [需求描述或brief文件路径]
allowed-tools: Write(//_briefs/**), Read(//*)
scripts:
  sh: scripts/bash/specify.sh
---

# 理解需求并保存Brief

## ⭐ 第一步：读取工作区配置（必须执行）

**核心原则**: 用户在 `content init` 时已选择工作区类型，直接从配置读取

### 1. 读取配置文件

使用 Read 工具读取 `.content/config.json`：

```bash
Read .content/config.json
```

### 2. 提取工作区类型

从配置文件中读取 `workspace` 字段：
- `"workspace": "wechat"` → 公众号工作区
- `"workspace": "video"` → 视频工作区
- `"workspace": "general"` → 通用工作区

### 3. 加载工作区配置

根据工作区类型，使用 Read 工具读取对应的配置文件：

```bash
# 公众号工作区
Read spec/presets/workspaces/wechat.md

# 视频工作区
Read spec/presets/workspaces/video.md

# 通用工作区
Read spec/presets/workspaces/general.md
```

### 4. 输出工作区加载提示

加载配置后，输出提示（从配置文件复制）：

**示例（公众号工作区）**:
```
✅ 当前工作区: **公众号写作 (wechat)**

📋 工作区规则:
- 段落控制: 每段 ≤ 150 字
- 配图要求: 5-8 张（必须完成）
- AI 味目标: < 30%

🎯 核心原则:
1. 选题讨论必做（不直接写文章）
2. 素材库优先（使用真实素材）
3. 三遍审校必做（系统化降 AI 味）
4. 配图必须完成（不只是建议）
```

**示例（视频工作区）**:
```
✅ 当前工作区: **视频脚本 (video)**

📋 工作区规则:
- 时长控制: 根据平台要求
- 口语化程度: 高（AI味 < 20%）
- Hook 设计: 前3秒抓人

🎯 核心原则:
1. 平台特性优先（抖音/B站/视频号规则不同）
2. 口播节奏控制（停顿、重音、语速）
3. 分镜脚本详细（画面、文案、转场）
```

**示例（通用工作区）**:
```
✅ 当前工作区: **通用内容 (general)**

📋 工作区规则:
- 格式: 标准 Markdown
- 灵活配置: 根据目标平台调整
- AI 味目标: < 35%

🎯 核心原则:
1. 平台适配（博客/知乎/Medium 格式不同）
2. SEO 优化（如需要）
3. 内容质量优先（真实性 > 格式）
```

---

## 第二步：处理用户需求

### 方式1: 用户直接描述需求

用户提供文字描述,例如:
> "写一篇关于Claude Code的文章,3000字左右,对比Cursor,目标读者是程序员"

**AI处理流程:**

1. **提取关键信息**:
   - 主题: Claude Code
   - 字数: 3000
   - 对比对象: Cursor
   - 目标读者: 程序员

2. **工作区已在第一步确定** ✅

3. **补充关键信息**(根据工作区配置差异化提问):

   **📋 根据工作区配置提问**（参考 spec/presets/workspaces/[workspace].md）

   **如果是 wechat 工作区:**
   - 文章定位? 请选择: (a) 干货教程 (b) 经验分享 (c) 观点分析 (d) 评测对比
   - 目标读者? 请选择: (a) 前端新手 (b) 有经验开发者 (c) 项目经理 (d) 其他
   - 期望字数? 请选择: (a) 2000-3000字 (b) 3000-4000字 (c) 4000-5000字
   - 封面图要求? 请选择: (a) 默认900x500px (b) 需要特定风格
   - 配图数量? 请选择: (a) 建议5-8张 (b) 具体需求
   - 敏感词检测需求? 请选择: (a) 政治敏感 (b) 色情内容 (c) 广告法 (d) 全部
   - 截稿时间? 请选择: (a) 今天 (b) 明天 (c) 本周内 (d) 其他

   **如果是 video 工作区:**
   - 视频时长? 请选择: (a) 30秒-1分钟 (b) 1-3分钟 (c) 3-5分钟 (d) 5分钟以上
   - 目标平台? 请选择: (a) 抖音 (b) B站 (c) 视频号 (d) 快手
   - 风格? 请选择: (a) 口播 (b) 剧情 (c) 混剪 (d) 其他
   - 语速? 请选择: (a) 正常160字/分 (b) 快节奏200字/分 (c) 慢节奏120字/分
   - Hook 策略? 请选择: (a) 前3秒抓人 (b) 悬念设置 (c) 痛点直击 (d) 其他
   - 截稿时间? 请选择: (a) 今天 (b) 明天 (c) 本周内 (d) 其他

   **如果是 general 工作区:**
   - 具体发布平台? 请选择: (a) 博客 (b) Medium (c) 知乎 (d) 技术文档
   - 内容定位? 请选择: (a) 技术教程 (b) 经验总结 (c) 观点文章 (d) 其他
   - 是否需要 SEO 优化? 请选择: (a) 是 (b) 否 (c) 不确定
   - 是否需要配图? 请选择: (a) 是 (b) 否 (c) 不确定
   - 期望 AI 味程度? 请选择: (a) < 30% (b) < 35% (c) < 40%
   - 口语化程度? 请选择: (a) 高 (b) 中 (c) 低
   - 截稿时间? 请选择: (a) 今天 (b) 明天 (c) 本周内 (d) 其他

   **重要**: 以上选项仅供参考，AI 应该根据用户的具体需求和主题，动态生成更合适的选项。例如：
   - 如果用户要写技术文章，目标读者选项应该是 (a) 初学者 (b) 中级开发者 (c) 高级开发者 (d) 架构师
   - 如果用户要写产品评测，文章定位选项应该是 (a) 功能对比 (b) 性能测试 (c) 使用体验 (d) 购买建议
   - AI 应该根据主题和上下文，提供最相关的选项

4. **生成 brief 草稿**,让用户确认

### 方式2: 用户上传brief文件

用户提供Word/PDF/Markdown文件:
> "这是客户给的brief: /path/to/brief.docx"

**AI处理流程:**
1. 读取文件内容
2. 解析结构化信息
3. 补充缺失字段
4. 生成标准格式brief

---

## Brief标准格式

保存到: `_briefs/项目名-brief.md`

```markdown
# 写作Brief - [项目名]

## 元信息
- **项目编号**: 001
- **创建时间**: 2025-01-15
- **截稿时间**: 2025-01-20
- **项目类型**: 商单/个人创作

## 内容需求

### 主题
[文章主题]

### 目标读者
- **主要读者**: [描述]
- **次要读者**: [描述]
- **读者痛点**: [痛点]

### 内容定位
- [x] 评测/对比
- [ ] 教程/指南
- [ ] 观点/分析
- [ ] 案例研究

### 字数要求
- **目标字数**: [字数]
- **可接受范围**: [范围]

### 发布平台
- **主平台**: [平台]
- **分发平台**: [平台]

## 内容要求

### 必须包含(P0)
- [ ] [要点1]
- [ ] [要点2]

### 建议包含(P1)
- [ ] [要点1]

### 可选内容(P2)
- [ ] [要点1]

## 风格要求

### 语言风格
- **基调**: [描述]
- **语气**: [描述]
- **专业度**: [描述]

### 结构要求
- **开头**: [要求]
- **中间**: [要求]
- **结尾**: [要求]

## 数据要求

### 需要真实测试
- [ ] 是
- [x] 否

**测试内容:**
[描述]

### 需要信息调研
- [x] 是

**调研内容:**
[描述]

## 真实经历需求 ⭐ 新增

> **核心原则**: 80%的内容必须来自你的真实经历

### 需要哪些真实经历

请在写作前检查是否已有以下真实经历:

- [ ] **产品使用体验** (至少3个具体场景)
  - 描述: [具体使用过程和感受]

- [ ] **对比测试数据** (需要真实测试)
  - 描述: [测试方法、场景、数据]

- [ ] **个人观点和思考**
  - 描述: [独特的视角和洞察]

- [ ] **踩坑经历**
  - 描述: [遇到的问题和解决过程]

### 素材库检查

在开始写作前,请确保你的个人素材库中有相关经历:

**检查清单:**
- [ ] 检查 `materials/raw/*.csv` 中是否有相关动态
- [ ] 检查个人笔记中是否有相关记录
- [ ] 检查是否有真实的测试数据和截图

**素材充足性评估:**
- [ ] ✅ 充足 - 有3个以上真实场景和数据
- [ ] ⚠️ 不足 - 只有1-2个场景,需要补充
- [ ] ❌ 缺失 - 完全没有相关经历

### ⚠️ 重要提醒

**如果素材库中没有足够的真实经历:**

1. **暂停写作项目**
2. **先积累素材**:
   - 实际使用/测试产品(至少3-5天)
   - 记录使用过程和数据
   - 导入到 materials/ 目录
3. **重新评估**:
   - 或者选择一个你有充足经历的主题

**原因:**
- 没有真实经历,写出来的内容会充满AI味
- 编辑能一眼识别出缺少真实细节的文章
- AI检测率会超过50%,无法通过审校

## 配图要求

- **配图数量**: [数量]
- **配图类型**: [类型]
- **配图风格**: [风格]

## 质量要求

### AI检测
- **目标AI浓度**: < 30%
- **审校轮次**: 至少2轮

## 内容红线

### 禁止内容
- ❌ [禁止项]

### 注意事项
- ⚠️ [注意项]

## 备注

[其他备注]
```

---

## 执行后操作

1. **保存brief文件**
   - 路径: `_briefs/项目编号-项目名-brief.md`
   - 自动生成项目编号(递增,从001开始)

2. **创建项目目录结构** (根据工作区类型)

   **wechat工作区:**
   ```
   workspaces/wechat/articles/001-项目名/
   ├── specification.md  (待生成)
   ├── materials-found.md (待生成)
   ├── draft.md          (待生成)
   ├── audit-log.md      (待生成)
   ├── images-plan.md    (待生成)
   ├── publish/          (待创建)
   └── images/           (待创建)
   ```

   **video工作区:**
   ```
   workspaces/video/scripts/001-项目名/
   ├── specification.md  (待生成)
   ├── script-draft.md   (待生成)
   ├── storyboard/       (待创建,如需分镜)
   ├── audit-log.md      (待生成)
   └── publish/          (待创建)
   ```

   **general工作区:**
   ```
   workspaces/general/posts/001-项目名/
   ├── specification.md  (待生成)
   ├── draft.md          (待生成)
   ├── audit-log.md      (待生成)
   └── publish/          (待创建)
   ```

3. **提示用户下一步并等待选择**
   ```
   ✅ Brief已保存: _briefs/001-项目名-brief.md

   📋 项目概览:
   - 主题: [主题]
   - 字数: [字数]
   - 截稿: [时间]
   - 需要测试: [是/否]
   - 需要调研: [是/否]

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   💡 下一步操作
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   a) /research - 开始信息调研
      适合: brief 中标注"需要调研"或需要搜集资料
      说明: 搜索官方文档、用户评价、技术评测等

   b) /topic - 讨论选题方向
      适合: 已有调研数据或无需调研的创作
      说明: 我会提供 3-4 个差异化的选题方向供您选择

   c) 查看工作区配置
      适合: 想先了解当前工作区的具体要求

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ⭐ 推荐: 如果 brief 中标注"需要调研",建议选择 a) 先调研

   ⚠️ 请输入 a/b/c 或直接输入命令(如 /research),我将继续后续流程
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ```

   **⚠️ 强制等待机制**:
   AI **必须停在这里,等待用户输入选择**,绝对不能自作主张进入下一步!

---

## 注意事项

1. **Brief必须明确** - 如果用户提供的信息不足,必须通过提问补充
2. **不要自作主张** - 所有未明确的信息都要询问,不要假设
3. **标准格式** - 必须按照上述格式保存,便于后续命令读取
4. **编号管理** - 项目编号自动递增,从001开始
5. **动态选项** - 所有选择项都应该根据用户的具体需求和主题动态生成，不要使用固定的选项列表
6. **选项标注** - 每个选择项都必须有清晰的 (a) (b) (c) (d) 标注，方便用户选择
7. **上下文相关** - 选项内容应该与用户的具体需求高度匹配，而不是通用的模板

---

## 常见问题

### Q: 用户只给了一个主题怎么办?
A: 必须通过提问补充关键信息:
- 字数要求
- 目标读者
- 发布平台
- 截稿时间

### Q: Brief中可以有哪些灵活性?
A: 以下字段可以灵活调整:
- 内容定位可以多选
- 字数可以是范围
- 配图数量可以是建议值
但以下字段必须明确:
- 主题
- 目标读者
- 发布平台

### Q: 如何处理商单brief?
A: 如果是商单,需要额外记录:
- 客户要求(明确标注)
- 付费金额(如有)
- 特殊限制(如不能贬低竞品)
